import torch
import numpy as np

if __name__ == "__main__":
    a = torch.Tensor([[[1, 1, 1], [1, 1, 1]], [[2, 2, 2], [2, 2, 2]]])
    b = torch.Tensor([[[1, 1, 1], [1, 1, 1]], [[2, 2, 2], [2, 2, 2]]])

print(a.shape)
print(torch.einsum("ijk, ifk->ijf", [a, b]))

a = np.array(
    [
        [
            6249317,
            24845281,
            19834224,
            26660985,
            18487397,
        ],
        [
            6169610,
            23064779,
            19278621,
            26016065,
            14927306,
        ],
        [
            6200513,
            22697178,
            19416199,
            26103120,
            14143796,
        ],
        [
            6310426,
            24683436,
            19918680,
            26688122,
            18284855,
        ],
        [
            6285328,
            24486619,
            19718588,
            26363048,
            17866572,
        ],
        [
            6295548,
            24698007,
            19992101,
            26621258,
            18221501,
        ],
        [
            6247499,
            24523203,
            20034545,
            26605865,
            18139838,
        ],
    ]
)

b = np.array([57081344, 52572195, 51491711, 56609138, 55934863, 56537552, 56194006])
print(a)
print(b)
coef = np.linalg.lstsq(a, b, rcond=None)
print(coef)
